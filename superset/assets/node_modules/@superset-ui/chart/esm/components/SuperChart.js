import _pt from"prop-types";function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _inheritsLoose(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a,a.__proto__=b}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}import*as React from"react";import{createSelector}from"reselect";import getChartComponentRegistry from"../registries/ChartComponentRegistrySingleton";import getChartTransformPropsRegistry from"../registries/ChartTransformPropsRegistrySingleton";import ChartProps from"../models/ChartProps";import createLoadableRenderer from"./createLoadableRenderer";var IDENTITY=function(a){return a},EMPTY=function(){return null},defaultProps={id:"",className:"",preTransformProps:IDENTITY,overrideTransformProps:void 0,postTransformProps:IDENTITY,onRenderSuccess:function a(){},onRenderFailure:function a(){}},BLANK_CHART_PROPS=new ChartProps;function getModule(a){return a.default?a.default:a}var SuperChart=/*#__PURE__*/function(a){function b(b){var c;c=a.call(this,b)||this,_defineProperty(_assertThisInitialized(c),"processChartProps",void 0),_defineProperty(_assertThisInitialized(c),"createLoadableRenderer",void 0),c.renderChart=c.renderChart.bind(_assertThisInitialized(c)),c.renderLoading=c.renderLoading.bind(_assertThisInitialized(c)),c.processChartProps=createSelector(function(a){return a.preTransformProps},function(a){return a.transformProps},function(a){return a.postTransformProps},function(a){return a.chartProps},function(a,b,c,d){return void 0===a&&(a=IDENTITY),void 0===b&&(b=IDENTITY),void 0===c&&(c=IDENTITY),c(b(a(d)))});var d=getChartComponentRegistry(),e=getChartTransformPropsRegistry();return c.createLoadableRenderer=createSelector(function(a){return a.chartType},function(a){return a.overrideTransformProps},function(a,b){if(a){var f=createLoadableRenderer({loader:{Chart:function b(){return d.getAsPromise(a)},transformProps:b?function(){return Promise.resolve(b)}:function(){return e.getAsPromise(a)}},loading:function d(b){return c.renderLoading(b,a)},render:c.renderChart});// Trigger preloading.
return f.preload(),f}return EMPTY}),c}_inheritsLoose(b,a);var c=b.prototype;return c.renderChart=function h(a,b){var c=getModule(a.Chart),d=getModule(a.transformProps),e=b.chartProps,f=b.preTransformProps,g=b.postTransformProps;return React.createElement(c,this.processChartProps({/* eslint-disable sort-keys */chartProps:e,preTransformProps:f,transformProps:d,postTransformProps:g/* eslint-enable sort-keys */}))},c.renderLoading=function d(a,b){var c=a.error;return c?React.createElement("div",{className:"alert alert-warning",role:"alert"},React.createElement("strong",null,"ERROR"),"\xA0",React.createElement("code",null,"chartType=\"",b,"\"")," \u2014",c.toString()):null},c.render=function l(){var a=this.props,b=a.id,c=a.className,d=a.preTransformProps,e=a.postTransformProps,f=a.chartProps,g=void 0===f?BLANK_CHART_PROPS:f,h=a.onRenderSuccess,i=a.onRenderFailure,j=this.createLoadableRenderer(this.props);// Create LoadableRenderer and start preloading
// the lazy-loaded Chart components
// Do not render if chartProps is set to null.
// but the pre-loading has been started in this.createLoadableRenderer
// to prepare for rendering once chartProps becomes available.
if(null===g)return null;var k={};return b&&(k.id=b),c&&(k.className=c),React.createElement("div",k,React.createElement(j,{preTransformProps:d,postTransformProps:e,chartProps:g,onRenderSuccess:h,onRenderFailure:i}))},b}(React.PureComponent);_defineProperty(SuperChart,"propTypes",{id:_pt.string,className:_pt.string,chartProps:_pt.oneOfType([_pt.any]),chartType:_pt.string.isRequired,preTransformProps:_pt.func,overrideTransformProps:_pt.func,postTransformProps:_pt.func,onRenderSuccess:_pt.func,onRenderFailure:_pt.func}),_defineProperty(SuperChart,"defaultProps",defaultProps);export{SuperChart as default};